

<table mat-table [dataSource]="evenements |guichetFermer" class="mat-elevation-z8">

    
    <ng-container  matColumnDef="sport">
      <th mat-header-cell *matHeaderCellDef> Sport </th>
      <td mat-cell *matCellDef="let element"> {{element.sport}}</td>
    </ng-container>
  
    
    <ng-container  matColumnDef="amphitheatre">
      <th mat-header-cell *matHeaderCellDef> Amphithéatre </th>
      <td mat-cell *matCellDef="let element"> {{element.amphitheatre.ville}} ({{element.amphitheatre.pays}}) </td>
    </ng-container>
  
    
    <ng-container  matColumnDef="date">
      <th mat-header-cell *matHeaderCellDef> Date </th>
      <td mat-cell *matCellDef="let element"> {{element.date}} </td>
    </ng-container>

    <ng-container  matColumnDef="section">
      <th mat-header-cell *matHeaderCellDef> Section </th>
      <td mat-cell *matCellDef="let element">
        <form #eventFormEdition="ngForm" id="eventFormEdition" (ngSubmit)="eventFormEdition.form.valid && onEdit(eventFormEdition)">
          <mat-form-field *ngIf="(selectedEvent && selectedEvent === element);else editpositionnement;" class="input-full-width">            
              <mat-label>Choisir une section</mat-label>
              <mat-select name="section" required matInput [(ngModel)]="element.positionement.section" placeholder="Choisir une section">
                <mat-option value="A">A</mat-option>
                <mat-option value="B">B</mat-option>
                <mat-option value="C">C</mat-option>
                <mat-option value="D">D</mat-option>
                <mat-option value="E">E</mat-option>
                <mat-option value="F">F</mat-option>
              </mat-select>                           
          </mat-form-field>
      </form>
      <ng-template #editpositionnement><span (click)="onSelect(element)">{{element.positionement.section}}</span></ng-template>
          </td>
    </ng-container>

    <ng-container  matColumnDef="ranger">
      <th mat-header-cell *matHeaderCellDef> Rangée </th>
      <td mat-cell *matCellDef="let element">
        <form #eventFormEdition="ngForm" id="eventFormEdition" (ngSubmit)="eventFormEdition.form.valid && onEdit(eventFormEdition)">
          <mat-form-field *ngIf="(selectedEvent && selectedEvent === element);else editranger;" class="input-full-width">            
            <input type="number" min="0" max="599" name="selectedEvenementranger" [(ngModel)]="selectedEvent.positionement.ranger" matInput required 
            name="rangerEdition" #prixEdition="ngModel">                           
          </mat-form-field>
      </form>
      <ng-template #editranger><span (click)="onSelect(element)">{{element.positionement.ranger}}</span></ng-template>
          </td>
    </ng-container>
       
    <ng-container  matColumnDef="siege">
      <th mat-header-cell *matHeaderCellDef> Rangée </th>
      <td mat-cell *matCellDef="let element">
        <form #eventFormEdition="ngForm" id="eventFormEdition" (ngSubmit)="eventFormEdition.form.valid && onEdit(eventFormEdition)">
          <mat-form-field *ngIf="(selectedEvent && selectedEvent === element);else editSiege;" class="input-full-width">            
            <input type="number" min="0" max="100" name="selectedEvenementranger" [(ngModel)]="selectedEvent.positionement.siege" matInput required 
            name="siegeEdition" #prixEdition="ngModel">                           
          </mat-form-field>
      </form>
      <ng-template #editSiege><span (click)="onSelect(element)">{{element.positionement.siege}}</span></ng-template>
          </td>
    </ng-container>


      <ng-container  matColumnDef="prix">
        <th mat-header-cell *matHeaderCellDef> Prix </th>
        <td mat-cell *matCellDef="let element">
          <form #eventFormEdition="ngForm" id="eventFormEdition" (ngSubmit)="eventFormEdition.form.valid && onEdit(eventFormEdition)">
            <mat-form-field *ngIf="(selectedEvent && selectedEvent === element);else editPrix;" class="input-full-width">
                <input type="number" name="selectedEvenementprix" [(ngModel)]="selectedEvent.prix" matInput required 
                   name="prixEdition" #prixEdition="ngModel">                
            </mat-form-field>
        </form>
        <ng-template #editPrix><span (click)="onSelect(element)">{{element.prix}}$</span></ng-template>
            </td>
      </ng-container>

      <ng-container matColumnDef="rabais">
        <th mat-header-cell *matHeaderCellDef> Rabais (en $) </th>
        <td mat-cell *matCellDef="let element">

          <form #eventFormEdition="ngForm" id="eventFormEdition" (ngSubmit)="eventFormEdition.form.valid && onEdit(eventFormEdition)">
            <mat-form-field *ngIf="(selectedEvent && selectedEvent === element);else editRabais;" class="input-full-width">
                <input type="number" min="0" name="selectedEvenementRabais" [(ngModel)]="selectedEvent.rabais" matInput required name="rabaisEdition" #rabaisEdition="ngModel">              
            </mat-form-field>
        </form>
        <ng-template #editRabais><span (click)="onSelect(element)">{{element.rabais}}</span></ng-template>                       
           </td>
      </ng-container>
      
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> </th>
        <td mat-cell *matCellDef="let evenements" class="boutonsAction">          
            <button *ngIf="(selectedEvent && selectedEvent === evenements);else editButton;" color="primary" form="eventFormEdition" 
              mat-button><i class="material-icons">done</i></button>
            <ng-template #editButton>
                <form (ngSubmit)="onSelect(evenements)">
                    <button mat-button><i class="material-icons">edit</i></button>
                </form>
            </ng-template>
            <form (ngSubmit)="onDelete(evenements)">
                <button mat-button ><i class="material-icons">delete</i></button>
            </form>
        </td>
     </ng-container>

     <div *ngIf="connection == false">
      <tr mat-header-row *matHeaderRowDef="displayedColumns1"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns1;"></tr>
     </div>
    
     <div *ngIf="connection == true">
      <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns2;"></tr>
     </div>

  </table>

  